{"version":3,"file":"commonlayout-370bdf92.js","sources":["../../../../src/renderer/components/common-layout/CommonLayout.tsx"],"sourcesContent":["import styles from './common-layout.module.less';\n\nimport { Menu } from 'antd';\nimport React, { useMemo } from 'react';\nimport { Outlet, useLocation, useNavigate } from 'react-router';\n\nconst menuItems = [\n  {\n    label: 'Home',\n    key: 'home',\n  },\n  {\n    label: 'Navigation Two',\n    key: 'navigation-two',\n    children: [\n      {\n        label: 'Option 2-1',\n        key: 'option-one',\n      },\n      {\n        label: 'Option 2-2',\n        key: 'option-two',\n      },\n      {\n        label: 'Option 2-3',\n        key: 'option-three',\n      },\n    ],\n  },\n  {\n    label: 'User',\n    key: 'user',\n  },\n];\n\nfunction findTargetMenuItemByPathname(menuItems = []) {\n  if (!menuItems.length) {\n    return;\n  }\n  let target = [];\n  menuItems.forEach((item) => {\n    const { key, children = [] } = item;\n    // 如果当前路由菜单的 key 在路由中找不到，则直接退出\n    if (location.pathname.indexOf(`/${key}`) === -1) {\n      return;\n    }\n    target.push(item.key);\n\n    const res = findTargetMenuItemByPathname(children);\n    if (res && res.length) {\n      target = target.concat(res);\n    }\n  });\n  return target;\n}\n\nfunction getFullPath(menuItem) {\n  if (!menuItem || !menuItem.key) {\n    return;\n  }\n  const { key, children = [] } = menuItem;\n  let arr = [key];\n  const res = getFullPath(children[0]);\n  if (res) {\n    arr = arr.concat(res);\n  }\n  return arr;\n}\n\nconst CommonLayout = () => {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const defaultOpenKeys = menuItems.map((item) => item.key);\n\n  const defaultSelectedKeys = useMemo(() => {\n    if (!location.pathname) {\n      return [];\n    }\n    if (location.pathname === '/') {\n      // 默认 menuItems 第一个菜单项为首页路由\n      return getFullPath(menuItems[0]);\n    }\n\n    return findTargetMenuItemByPathname(menuItems).reverse();\n  }, [location, menuItems]);\n\n  const handleMenuClick = ({ keyPath }) => {\n    const path = keyPath.reverse().join('/');\n    navigate(path);\n  };\n\n  return (\n    <div className={`${styles.commonLayout}`}>\n      <Menu\n        defaultOpenKeys={defaultOpenKeys}\n        defaultSelectedKeys={defaultSelectedKeys}\n        items={menuItems}\n        style={{ width: 200, height: '100%' }}\n        mode=\"inline\"\n        onClick={handleMenuClick}\n      />\n      <div className={styles.contentArea}>\n        <Outlet />\n      </div>\n    </div>\n  );\n};\n\nexport default CommonLayout;\n"],"names":["menuItems","findTargetMenuItemByPathname","menuItems2","target","item","key","children","res","getFullPath","menuItem","arr","CommonLayout","location2","useLocation","location","defaultSelectedKeys","useMemo","handleMenuClick","keyPath","path","navigate","React","styles","_Menu","defaultOpenKeys"],"mappings":"wUAOEA,EAAA,CAAA,CAAA,MACS,OAAA,IACF,MAAA,EACP,CACA,MAAA,iBAAA,IACS,iBAAA,SACF,CAAA,CACL,MAAU,aACR,IAAA,YAAA,EAAA,CACS,MACF,aACP,IAAA,YAAA,EACA,CAAA,MACS,aAAA,IACF,cAAA,CACP,CAAA,EACA,CAAA,MACS,OAAA,IAAA,MACF,CACP,EAAA,SACFC,EAAAC,EAAA,GAAA,CACF,GAAA,CAAAA,EAAA,OACA,OACS,IACFC,EAAA,CAAA,EACP,OAAAD,EAAA,QAAAE,GAAA,CACF,KAAA,CAES,IAAAC,EACH,SAAAC,GAAmB,CACrB,EAAAF,EACF,GAAA,SAAA,SAAA,QAAA,IAAAC,GAAA,IAAA,GACI,OAEFF,EAAQ,KAAAC,EAAgB,GAAA,EAExB,WAAiD,EAC/CG,GAAAA,EAAA,SACFJ,EAAAA,EAAA,OAAAI,CAAA,EAGA,CAAM,EACFJ,CACF,CAA0B,SAC5BK,EAAAC,EAAA,CACF,GAAC,CAAAA,GAAA,CAAAA,EAAA,IACM,OAGT,KAAA,CACE,IAAAJ,EACE,SAAAC,EAAA,CAAA,CACF,EAAAG,EACA,IAAAC,EAAQ,CAAAL,CAAgB,EACpB,MAAAE,EAAUC,EAAAF,EAAA,CAAA,CAAA,EACd,OAAAC,IACAG,EAASA,EAAA,OAAAH,CAAA,GAETG,CACA,CACF,MAAAC,EAAA,IAAA,CAEA,YACQC,EAAuBC,IACvBC,EAAuBd,EAAA,IAAAI,GAAAA,EAAA,GAAA,EACvBW,EAA4BC,EAAAA,QAAA,IAE5BJ,EAAA,SAGJA,EAAA,WAAA,IACIE,IAA2B,CAAA,CAAA,EAG/Bb,EAAAD,CAAA,EAAA,aAEO,CAAAY,EAAAZ,CAAA,CAAA,EACKiB,EAAS,CAAC,CAExB,QAAAC,CACE,IAAA,CACA,MAAAC,EAAaD,EAAA,QAAA,EAAA,KAAA,GAAA,EACfE,EAAAD,CAAA,CAEA,EAEK,OAAAE,EAAA,cAAA,MAAA,CAAA,UAAA,GAAAC,EAAA,cAAA,EACCD,EAAA,cAAAE,EAAA,CACA,gBAAAC,EAAA,oBAAAT,EACO,MACAf,EAA6B,MAC/B,CACL,MAAS,IAAA,OAAA,MAEX,EAKN,KAAA,SAEe,QAAAiB"}